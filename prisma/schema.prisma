generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model Tournament {
  id              String              @id @default(cuid()) @map("tournament_pkey")
  title           String
  numPlayers      Int
  description     String?
  private         Boolean             @default(false)
  privatePassword String?
  ownerId         String?             @map("owner_id")
  owner           User?               @relation(fields: [ownerId], references: [id], name: "UserTournaments")
  category        String?
  participants    TournamentParticipant[]
  createdAt       DateTime            @default(now()) @map("created_at")
  finishedAt      DateTime
}

model User {
  id                  String                   @id @default(cuid()) @map("user_pkey")
  name                String?
  lastName            String?
  email               String?                  @unique @map("user_email_key")
  country             String?
  password            String?
  position            String?
  createdAt           DateTime                 @default(now()) @map("created_at")
  username            String?                  @unique @map("user_username_key")
  prime               Boolean                  @default(false)
  tournaments         Tournament[]             @relation("UserTournaments")
  participants      TournamentParticipant[]
}

model TournamentParticipant {
  tournamentId String
  userId       String
  joinedAt     DateTime @default(now())

  tournament   Tournament @relation(fields: [tournamentId], references: [id])
  user         User       @relation(fields: [userId], references: [id])

  @@id([tournamentId, userId])
  @@map("tournament_participant_pkey")
}
